{"mappings":"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","sources":["src/index.ts","src/transport.ts"],"sourcesContent":["export * from \"./transport\";\n","import Daily, {\n  DailyCall,\n  DailyEventObjectAppMessage,\n  DailyEventObjectAvailableDevicesUpdated,\n  DailyEventObjectLocalAudioLevel,\n  DailyEventObjectParticipant,\n  DailyEventObjectParticipantLeft,\n  DailyEventObjectRemoteParticipantsAudioLevel,\n  DailyEventObjectSelectedDevicesUpdated,\n  DailyEventObjectTrack,\n  DailyParticipant,\n} from \"@daily-co/daily-js\";\nimport {\n  Participant,\n  Tracks,\n  Transport,\n  TransportStartError,\n  TransportState,\n  RTVIClientOptions,\n  RTVIMessage,\n  RTVIError,\n} from \"realtime-ai\";\n\nexport interface DailyTransportAuthBundle {\n  room_url: string;\n  token: string;\n}\n\nexport class DailyTransport extends Transport {\n  private declare _daily: DailyCall;\n  private _botId: string = \"\";\n  private _selectedCam: MediaDeviceInfo | Record<string, never> = {};\n  private _selectedMic: MediaDeviceInfo | Record<string, never> = {};\n\n  constructor() {\n    super();\n  }\n\n  public initialize(\n    options: RTVIClientOptions,\n    messageHandler: (ev: RTVIMessage) => void\n  ): void {\n    this._callbacks = options.callbacks ?? {};\n    this._onMessage = messageHandler;\n\n    const existingInstance = Daily.getCallInstance();\n    if (existingInstance) {\n      void existingInstance.destroy();\n    }\n\n    this._daily = Daily.createCallObject({\n      startVideoOff: !(options.enableCam == true),\n      startAudioOff: options.enableMic == false,\n      allowMultipleCallInstances: true,\n      dailyConfig: {},\n    });\n\n    this.attachEventListeners();\n\n    this.state = \"disconnected\";\n\n    console.debug(\"[RTVI Transport] Initialized\");\n  }\n\n  get state(): TransportState {\n    return this._state;\n  }\n\n  private set state(state: TransportState) {\n    if (this._state === state) return;\n\n    this._state = state;\n    this._callbacks.onTransportStateChanged?.(state);\n  }\n\n  async getAllCams() {\n    const { devices } = await this._daily.enumerateDevices();\n    return devices.filter((d) => d.kind === \"videoinput\");\n  }\n\n  updateCam(camId: string) {\n    this._daily\n      .setInputDevicesAsync({\n        videoDeviceId: camId,\n      })\n      .then((infos) => {\n        this._selectedCam = infos.camera;\n      });\n  }\n\n  get selectedCam() {\n    return this._selectedCam;\n  }\n\n  async getAllMics() {\n    const { devices } = await this._daily.enumerateDevices();\n    return devices.filter((d) => d.kind === \"audioinput\");\n  }\n\n  updateMic(micId: string) {\n    this._daily\n      .setInputDevicesAsync({\n        audioDeviceId: micId,\n      })\n      .then((infos) => {\n        this._selectedMic = infos.mic;\n      });\n  }\n\n  get selectedMic() {\n    return this._selectedMic;\n  }\n\n  enableMic(enable: boolean) {\n    this._daily.setLocalAudio(enable);\n  }\n\n  get isMicEnabled() {\n    return this._daily.localAudio();\n  }\n\n  enableCam(enable: boolean) {\n    this._daily.setLocalVideo(enable);\n  }\n\n  get isCamEnabled() {\n    return this._daily.localVideo();\n  }\n\n  tracks() {\n    const participants = this._daily?.participants() ?? {};\n    const bot = participants?.[this._botId];\n\n    const tracks: Tracks = {\n      local: {\n        audio: participants?.local?.tracks?.audio?.persistentTrack,\n        video: participants?.local?.tracks?.video?.persistentTrack,\n      },\n    };\n\n    if (bot) {\n      tracks.bot = {\n        audio: bot?.tracks?.audio?.persistentTrack,\n        video: bot?.tracks?.video?.persistentTrack,\n      };\n    }\n\n    return tracks;\n  }\n\n  async initDevices() {\n    if (!this._daily) {\n      throw new RTVIError(\"Transport instance not initialized\");\n    }\n\n    this.state = \"initializing\";\n\n    const infos = await this._daily.startCamera();\n    const { devices } = await this._daily.enumerateDevices();\n    const cams = devices.filter((d) => d.kind === \"videoinput\");\n    const mics = devices.filter((d) => d.kind === \"audioinput\");\n    this._callbacks.onAvailableCamsUpdated?.(cams);\n    this._callbacks.onAvailableMicsUpdated?.(mics);\n    this._selectedCam = infos.camera;\n    this._callbacks.onCamUpdated?.(infos.camera as MediaDeviceInfo);\n    this._selectedMic = infos.mic;\n    this._callbacks.onMicUpdated?.(infos.mic as MediaDeviceInfo);\n\n    // Instantiate audio observers\n    if (!this._daily.isLocalAudioLevelObserverRunning())\n      await this._daily.startLocalAudioLevelObserver(100);\n    if (!this._daily.isRemoteParticipantsAudioLevelObserverRunning())\n      await this._daily.startRemoteParticipantsAudioLevelObserver(100);\n\n    this.state = \"initialized\";\n  }\n\n  async connect(\n    authBundle: DailyTransportAuthBundle,\n    abortController: AbortController\n  ) {\n    if (!this._daily) {\n      throw new RTVIError(\"Transport instance not initialized\");\n    }\n\n    if (abortController.signal.aborted) return;\n\n    this.state = \"connecting\";\n\n    try {\n      await this._daily.join({\n        url: authBundle.room_url,\n        token: authBundle.token,\n      });\n\n      const room = await this._daily.room();\n      if (room && \"id\" in room) {\n        this._expiry = room.config?.exp;\n      }\n    } catch (e) {\n      this.state = \"error\";\n      throw new TransportStartError();\n    }\n\n    if (abortController.signal.aborted) return;\n\n    this.state = \"connected\";\n\n    this._callbacks.onConnected?.();\n  }\n\n  async sendReadyMessage(): Promise<void> {\n    return new Promise<void>((resolve) => {\n      (async () => {\n        this._daily.on(\"track-started\", (ev) => {\n          if (!ev.participant?.local) {\n            this.state = \"ready\";\n            this.sendMessage(RTVIMessage.clientReady());\n            resolve();\n          }\n        });\n      })();\n    });\n  }\n\n  private attachEventListeners() {\n    this._daily.on(\n      \"available-devices-updated\",\n      this.handleAvailableDevicesUpdated.bind(this)\n    );\n    this._daily.on(\n      \"selected-devices-updated\",\n      this.handleSelectedDevicesUpdated.bind(this)\n    );\n\n    this._daily.on(\"track-started\", this.handleTrackStarted.bind(this));\n    this._daily.on(\"track-stopped\", this.handleTrackStopped.bind(this));\n    this._daily.on(\n      \"participant-joined\",\n      this.handleParticipantJoined.bind(this)\n    );\n    this._daily.on(\"participant-left\", this.handleParticipantLeft.bind(this));\n    this._daily.on(\"local-audio-level\", this.handleLocalAudioLevel.bind(this));\n    this._daily.on(\n      \"remote-participants-audio-level\",\n      this.handleRemoteAudioLevel.bind(this)\n    );\n    this._daily.on(\"app-message\", this.handleAppMessage.bind(this));\n    this._daily.on(\"left-meeting\", this.handleLeftMeeting.bind(this));\n  }\n\n  async disconnect() {\n    this._daily.stopLocalAudioLevelObserver();\n    this._daily.stopRemoteParticipantsAudioLevelObserver();\n\n    await this._daily.leave();\n    await this._daily.destroy();\n  }\n\n  public sendMessage(message: RTVIMessage) {\n    this._daily.sendAppMessage(message, \"*\");\n  }\n\n  private handleAppMessage(ev: DailyEventObjectAppMessage) {\n    // Bubble any messages with rtvi-ai label\n    if (ev.data.label === \"rtvi-ai\") {\n      this._onMessage({\n        id: ev.data.id,\n        type: ev.data.type,\n        data: ev.data.data,\n      } as RTVIMessage);\n    }\n  }\n\n  private handleAvailableDevicesUpdated(\n    ev: DailyEventObjectAvailableDevicesUpdated\n  ) {\n    this._callbacks.onAvailableCamsUpdated?.(\n      ev.availableDevices.filter((d) => d.kind === \"videoinput\")\n    );\n    this._callbacks.onAvailableMicsUpdated?.(\n      ev.availableDevices.filter((d) => d.kind === \"audioinput\")\n    );\n  }\n\n  private handleSelectedDevicesUpdated(\n    ev: DailyEventObjectSelectedDevicesUpdated\n  ) {\n    if (this._selectedCam?.deviceId !== ev.devices.camera) {\n      this._selectedCam = ev.devices.camera;\n      this._callbacks.onCamUpdated?.(ev.devices.camera as MediaDeviceInfo);\n    }\n    if (this._selectedMic?.deviceId !== ev.devices.mic) {\n      this._selectedMic = ev.devices.mic;\n      this._callbacks.onMicUpdated?.(ev.devices.mic as MediaDeviceInfo);\n    }\n  }\n\n  private handleTrackStarted(ev: DailyEventObjectTrack) {\n    this._callbacks.onTrackStarted?.(\n      ev.track,\n      ev.participant ? dailyParticipantToParticipant(ev.participant) : undefined\n    );\n  }\n\n  private handleTrackStopped(ev: DailyEventObjectTrack) {\n    this._callbacks.onTrackStopped?.(\n      ev.track,\n      ev.participant ? dailyParticipantToParticipant(ev.participant) : undefined\n    );\n  }\n\n  private handleParticipantJoined(ev: DailyEventObjectParticipant) {\n    const p = dailyParticipantToParticipant(ev.participant);\n\n    this._callbacks.onParticipantJoined?.(p);\n\n    if (p.local) return;\n\n    this._botId = ev.participant.session_id;\n\n    this._callbacks.onBotConnected?.(p);\n  }\n\n  private handleParticipantLeft(ev: DailyEventObjectParticipantLeft) {\n    const p = dailyParticipantToParticipant(ev.participant);\n\n    this._callbacks.onParticipantLeft?.(p);\n\n    if (p.local) return;\n\n    this._botId = \"\";\n\n    this._callbacks.onBotDisconnected?.(p);\n  }\n\n  private handleLocalAudioLevel(ev: DailyEventObjectLocalAudioLevel) {\n    this._callbacks.onLocalAudioLevel?.(ev.audioLevel);\n  }\n\n  private handleRemoteAudioLevel(\n    ev: DailyEventObjectRemoteParticipantsAudioLevel\n  ) {\n    const participants = this._daily.participants();\n    const ids = Object.keys(ev.participantsAudioLevel);\n    for (let i = 0; i < ids.length; i++) {\n      const id = ids[i];\n      const level = ev.participantsAudioLevel[id];\n      this._callbacks.onRemoteAudioLevel?.(\n        level,\n        dailyParticipantToParticipant(participants[id])\n      );\n    }\n  }\n\n  private handleLeftMeeting() {\n    this.state = \"disconnecting\";\n    this._botId = \"\";\n    this._callbacks.onDisconnected?.();\n  }\n}\n\nconst dailyParticipantToParticipant = (p: DailyParticipant): Participant => ({\n  id: p.user_id,\n  local: p.local,\n  name: p.user_name,\n});\n"],"names":[],"version":3,"file":"index.module.js.map"}